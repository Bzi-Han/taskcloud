# CoreServiceProtocol

### 握手

**请求包**

| 结构 | 包长度 | 指令 | 密钥长度 | 密钥 |
| - | - | - | - | - |
| 大小 | 4 | 1 | 4 | - |
| 示例 | - | handshake | 7 | "Bzi_Han" |

**响应包**

| 结构 | 包长度 | 指令 | 握手结果 |
| - | - | - | - |
| 大小 | 4 | 1 | 1 |
| 示例 | 2 | handshake | true/false |

### 运行

**请求包**

| 结构 | 包长度 | 指令 | 用户ID | 任务ID | 任务类型 | 任务名称长度 | 任务名称 | 任务脚本长度 | 任务脚本 | 通行证长度 | 通行证 | 调用的函数的长度 | 调用的函数 |
| - | - | - | - | - | - | - | - | - | - | - | - | - | - |
| 大小 | 4 | 1 | 8 | 8 | 1 | 4 | - | 4 | - | 4 | - | 4 | - |
| 示例 | - | run | 1 | 1 | lua | - | - | - | - | - | - | - | - |

**响应包**

| 结构 | 包长度 | 指令 | 任务投递结果 | 任务处理ID |
| - | - | - | - | - |
| 大小 | 4 | 1 | 1 | 8 |
| 示例 | - | run | true/false | - |

### 停止

**请求包**

| 结构 | 包长度 | 指令 | 任务处理ID |
| - | - | - | - |
| 大小 | 4 | 1 | 8 |
| 示例 | - | stop | - |

**响应包**

| 结构 | 包长度 | 指令 | 任务停止结果 |
| - | - | - | - |
| 大小 | 4 | 1 | 1 |
| 示例 | - | stop | true/false |

### 运行状态

**请求包**

| 结构 | 包长度 | 指令 | 任务处理ID |
| - | - | - | - |
| 大小 | 4 | 1 | 8 |
| 示例 | - | status | - |

**响应包**

| 结构 | 包长度 | 指令 | 任务运行状态 |
| - | - | - | - |
| 大小 | 4 | 1 | 1 |
| 示例 | - | status | waiting/running/finished/none |

### 日志

**响应包**

| 结构 | 包长度 | 指令 | 用户ID | 任务ID | 日志类型 | 任务名称长度 | 任务名称 | 日志长度 | 日志 |
| - | - | - | - | - | - | - | - | - | - |
| 大小 | 4 | 1 | 8 | 8 | 1 | 4 | - | 4 | - |
| 示例 | - | log | 1 | 1 | info | 4 | "test" | 4 | "data" |

### 结果

**响应包**

| 结构 | 包长度 | 指令 | 用户ID | 任务ID | 任务运行结果 | 任务处理ID |
| - | - | - | - | - | - | - |
| 大小 | 4 | 1 | 8 | 8 | 1 | 8 |
| 示例 | - | result | 1 | 1 | true/false | - |